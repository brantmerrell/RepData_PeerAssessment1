---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
download file, storing in temporary zip file  
 ```{r}download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",
              "temp.zip") ```  
unzip files from temporary zip file  
```{r} unzip("temp.zip") ```  

read the only csv file listed, store as DF  
```{r} DF <- read.csv(list.files(pattern="csv"))```  

## What is mean total number of steps taken per day?  
for each date in DF, add all steps. Store result as dailySum  
```{r} dailySum <- aggregate(formula = steps~date, 
                              FUN = sum, 
                              data = DF)```
create histogram of steps per day  
```{r} hist(dailySum$steps, xlab = "steps per day", main = "Histogram of steps per day")```

## What is the average daily activity pattern?  
for each interval in DF, calculate the mean of all steps. Store result as stepInterval.  
```{r} stepInterval <- aggregate(formula = steps~interval, 
                                  FUN = mean, 
                                  data = DF)```
plot average steps as a function of interval  
plot(steps~interval, data=stepInterval,type="l")  
print the interval with the maximum mean of steps  
```{r} 
stepInterval[which.max(stepInterval$steps),"interval"]
```  
```
[1] 835
```  
## Imputing missing values  
total number of missing values in the dataset  
```{r} 
sum(is.na(DF$steps)
    ```  
```
[1] 2304
```  
```{r} 
newDF <- DF  
naVec <- is.na(newDF$steps)  
newDF[naVec,"steps"] <- mean(newDF[,"steps"],na.rm=T)
dailySum <- aggregate(steps~date,data=newDF,sum)
hist(dailySum[,"steps"])
mean(totalSteps2$steps)  
median(totalSteps2$steps)
```  

## Are there differences in activity patterns between weekdays and weekends?  
```{r} 
weekendVec <- as.POSIXlt(as.Date(newDF$date))$wday %in% c(0,6)
newDF <- cbind(newDF, dayType=weekendVec)
newDF[weekendVec,"dayType"] <- "weekend"
newDF[!weekendVec,"dayType"] <- "weekday"
newDF[seq(1,nrow(DF),length.out=20),]
```

```{r}
stepInterval <- aggregate(steps~interval+date,newDF,mean)
xyplot(steps~interval|factor(date),data=stepInterval,aspect=1/2,type="l")
```